<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.book.module.mapper.CategoryMapper">

    <!-- 插入 -->
    <insert id="insert" parameterType="com.example.book.module.entity.Category">
        insert into category (
        <if test="category.categoryImages != null and category.categoryImages != ''">
            category_images,
        </if>
        <if test="category.categoryName != null and category.categoryName != ''">
            category_name,
        </if>
        <if test="category.parentId != null">
            parent_id,
        </if>
        is_deleted
        ) values (
        <if test="category.categoryImages != null and category.categoryImages != ''">
            #{categoryImages},
        </if>
        <if test="category.categoryName != null and category.categoryName != ''">
            #{categoryName},
        </if>
        #{parentId},
        #{isDeleted}
        )
    </insert>

    <!--更新-->
    <update id="update" parameterType="com.example.book.module.entity.Category">
        update category
        <set>
            <if test="category.categoryImages != null and category.categoryImages != ''">
                category_images = #{categoryImages},
            </if>
            <if test="category.categoryName != null and category.categoryName != ''">
                category_name = #{categoryName},
            </if>
            parent_id = #{parentId}
        </set>
        where id = #{id}
    </update>

    <select id="getByOffset" resultType="com.example.book.module.entity.Category">
        select * from category
        where is_deleted = 0
        order by id desc
        limit #{limit} offset #{offset}
    </select>

    <select id="getCategoryIds" resultType="java.lang.Long">
        SELECT id
        FROM category
        WHERE category_name LIKE CONCAT('%', #{keyword}, '%') AND is_deleted = 0
        LIMIT 99
    </select>

</mapper>
